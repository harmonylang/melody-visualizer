(this["webpackJsonpmelody-visualizer"]=this["webpackJsonpmelody-visualizer"]||[]).push([[0],{201:function(e,t){},202:function(e,t){},246:function(e,t,a){},247:function(e,t,a){},248:function(e,t,a){},249:function(e,t,a){},255:function(e,t){},261:function(e,t,a){},262:function(e,t,a){},363:function(e,t,a){},364:function(e,t,a){},431:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(40),i=a.n(r),c=(a(246),a(5)),l=(a(247),a(15)),o=a(16),u=a(20),h=a(19),d=(a(248),a(249),a(235)),b=a(8),p=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(b.jsx)(d.a,{options:{zoom:!0,width:"100%",height:"100vh"},dot:this.props.harmonyGV.replace('rankdir = "LR"','rankdir = "LR"\n                bgcolor="black"\n                node[style=outline, color=white, fontcolor=white]\n                edge[color=white, fontcolor=white]\n            ')})}}]),a}(n.a.Component),j=p,m=a.p+"static/media/logo.da5a3132.svg",f=a(82),v=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).state={displayStr:s.props.displayStr,harmonyGV:s.props.harmonyGV,displayGraph:!1},s}return Object(o.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.harmonyGV===e.harmonyGV&&this.props.displayStr===e.displayStr||this.setState({displayStr:e.displayStr,harmonyGV:e.harmonyGV,displayGraph:this.props.harmonyGV!==e.harmonyGV}),!0}},{key:"render",value:function(){var e,t,a=this,s=["Strumming threads...","Simulating parallel universes...","Revising the halting problem...","Adding the 51st state...","Testing for the delta invariant...","Modeling ecological collapse...","Guaranteeing money back...","Some assembly required..."];return Object(b.jsx)(b.Fragment,{children:this.state.displayGraph?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(f.a,{className:"hide-graph-btn",onClick:function(){a.setState({displayGraph:!1})},children:"Back"}),Object(b.jsx)(j,{harmonyGV:null!==(e=this.state.harmonyGV)&&void 0!==e?e:""})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("img",{src:m,alt:"Harmony Logo",width:128,height:128,className:"harmony-icon"}),Object(b.jsx)("h2",{className:"harmony-icon-subtitle",children:null!==(t=this.state.displayStr)&&void 0!==t?t:s[Math.floor(Math.random()*s.length)]}),this.state.harmonyGV?Object(b.jsx)(f.a,{className:"see-graph-btn",onClick:function(){a.setState({displayGraph:!0})},children:"See Graph"}):this.state.displayStr&&Object(b.jsx)(f.a,{className:"see-graph-btn",onClick:function(){parent.window.postMessage({command:"requestGraph",data:null},"*")},children:"Generate Graph"}),Object(b.jsxs)("svg",{className:"hero-waves",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 24 150 28 ",preserveAspectRatio:"none",children:[Object(b.jsx)("defs",{children:Object(b.jsx)("path",{id:"wave-path",d:"M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"})}),Object(b.jsx)("g",{className:"wave1",children:Object(b.jsx)("use",{xlinkHref:"#wave-path",x:"50",y:"2",fill:"rgba(255,255,255, .1)"})}),Object(b.jsx)("g",{className:"wave2",children:Object(b.jsx)("use",{xlinkHref:"#wave-path",x:"50",y:"0",fill:"rgba(255,255,255, .2)"})}),Object(b.jsx)("g",{className:"wave3",children:Object(b.jsx)("use",{xlinkHref:"#wave-path",x:"50",y:"8",fill:"#fff"})})]}),Object(b.jsx)("div",{className:"hero-bottom-bar"})]})})}}]),a}(n.a.Component),O=a(443),g=a(458),y=a(194),x=a.n(y),k=a(164),S=(a(261),a(445)),w=a(441),V=a(444),C=a(80),N=a(191),T=a.n(N),D=(a(262),function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).state={listRefs:s.props.code.reduce((function(e,t){return e.set(t.initialPc,n.a.createRef()),e}),new Map),highlightRef:n.a.createRef()},s}return Object(o.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return this.scrollToValue(e.pcValue),this.props.code!==e.code}},{key:"scrollToValue",value:function(e){var t;null===(t=this.state.listRefs.get(e))||void 0===t||t.current.scrollIntoView({behavior:"auto",block:"start"}),this.state.highlightRef.current.style.top=25*e+"px"}},{key:"render",value:function(){var e=this;return Object(b.jsxs)(w.a,{size:"small",title:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(S.a,{})," Assembly"]}),className:"assembly-card",children:[Object(b.jsx)(V.b,{size:"small",className:"card-list",dataSource:this.props.code,renderItem:function(t){return Object(b.jsx)(b.Fragment,{children:t.assembly.map((function(a,s){var n=s+t.initialPc;return Object(b.jsx)(V.b.Item,{className:"assembly-list-item",children:Object(b.jsxs)("div",{ref:e.state.listRefs.get(n),children:[Object(b.jsx)(T.a,{disabled:!0,children:n}),"\xa0",a.assembly,Object(b.jsx)(C.a,{title:t.sourceCode,children:Object(b.jsxs)(T.a,{type:"warning",className:"assembly-list-text",children:[t.file.substring(t.file.lastIndexOf("/")+1).replace(".hny",""),":",t.line]})})]})},n)}))})}}),Object(b.jsx)("div",{ref:this.state.highlightRef,style:{position:"absolute",top:0,width:"100%",height:25,zIndex:8,backgroundColor:"#ffffff20"}})]})}}]),a}(n.a.Component)),G=a(14),I=a(446),F=a(447),R=a(448),z=a(449),B=a(438),M=a(439),E=a(442),L=(a(363),["#c62828","#AD1457","#6A1B9A","#4527A0","#283593","#1565C0","#0277BD","#00838F","#00695C","#2E7D32","#558B2F","#9E9D24","#F9A825","#FF8F00","#EF6C00","#D84315","#4E342E","#424242","#37474F"]),P=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s,r;Object(l.a)(this,a),(r=t.call(this,e)).interval=void 0,r.processBarsRef=void 0;var i=0,c=new Map,o=[],u=[];null===(s=e.blocks)||void 0===s||s.forEach((function(t){var a=t.tid,s=t.name,n=t.startSliceIdx,r=t.lastSliceIdx;c.has(a)||(o.push(s),c.set(a,{blocks:[]}));for(var l=c.get(a),u=n;u<r;u++){var h=e.slices[u];null===l||void 0===l||l.blocks.push({start:i,length:h.duration,color:""}),i+=h.duration}}));var h=0;return c.forEach((function(e){e.blocks.forEach((function(e){return e.color=L[h%L.length]})),u.push(e),h++})),r.processBarsRef=n.a.createRef(),r.onClickTimeline=r.onClickTimeline.bind(Object(G.a)(r)),r.state={playing:!1,dragging:!1,totalDuration:i,processLabels:o,processBars:u},r}return Object(o.a)(a,[{key:"tick",value:function(){var e,t=this.props.stepValue;this.state.playing&&(t+1<this.state.totalDuration?(null===(e=this.processBarsRef.current)||void 0===e||e.scrollTo({top:0,left:5*(t+1),behavior:"auto"}),this.setStepValue(t+1)):this.setState({playing:!1}))}},{key:"stepForwards",value:function(){var e=this.props.stepValue;e<this.state.totalDuration&&this.setStepValue(e+1)}},{key:"stepBackwards",value:function(){var e=this.props.stepValue;e>0&&this.setStepValue(e-1)}},{key:"togglePlaying",value:function(){this.setState({playing:!this.state.playing})}},{key:"setStepValue",value:function(e){this.props.setStepValue(e)}},{key:"onClickTimeline",value:function(e){e.preventDefault(),this.setState({dragging:!0}),this.setState({playing:!1});var t=e.currentTarget,a=t.getBoundingClientRect();this.setStepValue(Math.round((e.clientX-a.left+t.scrollLeft)/5))}},{key:"onDragTimeline",value:function(e){if(e.preventDefault(),this.state.dragging){var t=e.currentTarget,a=t.getBoundingClientRect();this.setStepValue(Math.round((e.clientX-a.left+t.scrollLeft)/5))}}},{key:"onUnclickTimeline",value:function(e){e.preventDefault(),this.setState({dragging:!1})}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){return e.tick()}),100)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)(B.a,{className:"timeline-card",children:[Object(b.jsxs)(M.a,{className:"timeline-bar",children:[Object(b.jsx)(f.a,{shape:"circle",icon:Object(b.jsx)(I.a,{}),size:"middle",className:"timeline-bar-btn",onClick:function(){return e.stepBackwards()}}),Object(b.jsx)(f.a,{shape:"circle",icon:this.state.playing?Object(b.jsx)(F.a,{}):Object(b.jsx)(R.a,{}),size:"middle",className:"timeline-bar-btn",onClick:function(){return e.togglePlaying()}}),Object(b.jsx)(f.a,{shape:"circle",icon:Object(b.jsx)(z.a,{}),size:"middle",className:"timeline-bar-btn",onClick:function(){return e.stepForwards()}}),Object(b.jsx)(E.a,{onChange:function(t){return e.setStepValue(t)},value:this.props.stepValue,style:{flexGrow:1},max:this.state.totalDuration,className:"timeline-slider"})]}),Object(b.jsxs)(M.a,{className:"timeline-holder",children:[Object(b.jsx)(B.a,{span:6,children:Object(b.jsx)(V.b,{bordered:!1,dataSource:this.state.processLabels,renderItem:function(e){return Object(b.jsx)(V.b.Item,{className:"timeline-process-title",children:e})}})}),Object(b.jsxs)(B.a,{span:18,ref:this.processBarsRef,style:{overflowX:"scroll"},onMouseUp:this.onUnclickTimeline.bind(this),onMouseLeave:this.onUnclickTimeline.bind(this),onMouseMove:this.onDragTimeline.bind(this),onMouseDown:this.onClickTimeline.bind(this),children:[Object(b.jsx)(V.b,{bordered:!1,dataSource:this.state.processBars,style:{width:5*this.state.totalDuration},renderItem:function(e){return Object(b.jsx)(V.b.Item,{style:{position:"relative",padding:0,height:"3em"},children:e.blocks.map((function(e){return Object(b.jsx)("div",{style:{position:"absolute",left:5*e.start,width:5*e.length,height:"3em",backgroundColor:e.color}})}))})}}),Object(b.jsx)("div",{className:"timeline-indicator-bar",style:{left:5*this.props.stepValue}})]})]})]})}}]),a}(n.a.Component),A=a(450),U=a(113),J=a(240),H=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(l.a)(this,a);return(s=t.call(this,e)).state={sharedValues:function e(t){return Object.entries(t).map((function(t){var a=Object(c.a)(t,2),n=a[0],r=a[1];return null==r||"object"!==typeof r?{title:"".concat(n,": ").concat(s.formatVariableValue(r)),key:n,children:[]}:{title:n,key:n,children:e(r)}}))}(s.props.sharedVariables)},s}return Object(o.a)(a,[{key:"formatVariableValue",value:function(e){var t=typeof e;if("string"===t)return e.startsWith("?")?"".concat(e):'"'.concat(e,'"');if("boolean"===t||"number"===t){var a=e.toString();return a[0].toUpperCase()+a.substring(1)}return null==e?"None":JSON.stringify(e)}},{key:"render",value:function(){return Object(b.jsx)(w.a,{size:"small",title:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(A.a,{})," Variables"]}),className:"variables-card",children:Object(b.jsx)(J.a,{showIcon:!0,defaultExpandAll:!0,defaultSelectedKeys:["0-0-0"],switcherIcon:Object(b.jsx)(U.a,{}),treeData:this.state.sharedValues})})}}]),a}(n.a.Component),X=a(451),W=a(452),q=a(453),K=a(454),Q=a(455),Y=a(456),Z=a(457),$=a(440),_=(a(364),function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(l.a)(this,a),s=t.call(this,e);var n,r=function(e,t){var a=s.props.currentStackTrace.idToStackTrace[t].callStack[e];return a?Object.entries(a.vars).map((function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1];return"".concat(a," = ").concat(s.formatVariableValue(n))})).join("\n"):""};return s.state={processTableData:(n=s.props.currentStackTrace.idToStackTrace,Object.keys(n).map((function(e,t){var a=n[e];return{process:{name:s.props.threadNames[e],status:a.fullStatus},stacktrace:a.callStack.map((function(e,t){return e.method})).join("\n"),variables:r(0,e)}})))},s}return Object(o.a)(a,[{key:"formatVariableValue",value:function(e){var t=typeof e;if("string"===t)return e.startsWith("?")?"".concat(e):'"'.concat(e,'"');if("boolean"===t||"number"===t){var a=e.toString();return a[0].toUpperCase()+a.substring(1)}return null==e?"None":JSON.stringify(e)}},{key:"render",value:function(){var e=[{title:"Process",dataIndex:"process",key:"process",render:function(e){return Object(b.jsxs)("span",{children:[Object(b.jsx)(C.a,{title:e.status,children:function(e){switch(e){case"running":case"running atomic":case"running atomic read-only":return Object(b.jsx)(X.a,{twoToneColor:"#7cb305"});case"runnable":case"runnable atomic":case"runnable atomic read-only":return Object(b.jsx)(W.a,{twoToneColor:"#7cb305"});case"failed":return Object(b.jsx)(q.a,{twoToneColor:"#a8071a"});case"blocked":case"blocked atomic":case"blocked atomic read-only":return Object(b.jsx)(K.a,{twoToneColor:"#a8071a"});case"terminated":return Object(b.jsx)(Q.a,{twoToneColor:"#7cb305"});case"choosing":return Object(b.jsx)(Y.a,{twoToneColor:"#d4b106"});default:return console.log(e),Object(b.jsx)(Z.a,{})}}(e.status)}),"  ",e.name]})}},{title:"Stack Trace",dataIndex:"stacktrace",key:"stacktrace",render:function(e){return Object(b.jsx)("span",{children:e})}},{title:"Variables",dataIndex:"variables",key:"variables",render:function(e){return Object(b.jsx)("span",{children:e})}}];return Object(b.jsx)($.a,{className:"stacktrace-table",style:{whiteSpace:"pre"},columns:e,dataSource:this.state.processTableData,pagination:!1})}}]),a}(n.a.Component)),ee=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;Object(l.a)(this,a);var n=(s=t.call(this,e)).props.harmonyData.microSteps[0],r=s.props.harmonyData.slices[n.sliceIdx];return s.state={stepValue:0,currentPc:0,currentSlice:r},s}return Object(o.a)(a,[{key:"setStepValue",value:function(e){var t=this.props.harmonyData.microSteps[e];if(t){var a=this.props.harmonyData.slices[t.sliceIdx];this.setState({stepValue:e,currentPc:t.pc,currentSlice:a})}}},{key:"render",value:function(){var e=this;return Object(b.jsx)(x.a,{className:"fullscreen",children:Object(b.jsx)(y.Content,{className:"fullscreen",children:Object(b.jsxs)(k.a,{split:"horizontal",minSize:300,defaultSize:"70%",children:[Object(b.jsxs)(k.a,{split:"vertical",minSize:100,defaultSize:300,children:[Object(b.jsxs)("div",{children:[Object(b.jsx)(O.a,{className:"issue-header",title:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(g.a,{}),"\xa0\xa0",this.props.harmonyData.issue]})}),Object(b.jsxs)(k.a,{split:"horizontal",minSize:200,defaultSize:"60%",children:[Object(b.jsx)(D,{code:this.props.harmonyData.executedCode,pcValue:this.state.currentPc}),Object(b.jsx)(H,{sharedVariables:this.state.currentSlice.sharedValues},JSON.stringify(this.state.currentSlice.sharedValues))]})]}),Object(b.jsx)(_,{currentStackTrace:this.state.currentSlice,threadNames:this.props.harmonyData.idToThreadName},JSON.stringify(this.state.currentSlice))]}),Object(b.jsx)(P,{stepValue:this.state.stepValue,setStepValue:function(t){return e.setStepValue(t)},blocks:this.props.harmonyData.macroSteps,slices:this.props.harmonyData.slices})]})})})}}]),a}(n.a.Component);var te=function(){var e=Object(s.useState)(void 0),t=Object(c.a)(e,2),a=t[0],r=t[1],i=Object(s.useState)(void 0),l=Object(c.a)(i,2),o=l[0],u=l[1],h=Object(s.useState)(void 0),d=Object(c.a)(h,2),p=d[0],j=d[1],m=Object(s.useState)(!1),f=Object(c.a)(m,2),O=f[0],g=f[1];return n.a.useEffect((function(){var e=function(e){var t=e.data,a=t.command,s=t.jsonData;switch(a){case"load":g(!0),setTimeout((function(){return g(!1)}),200),r(s);break;case"load-graph":u(s);break;case"message":j(s)}};return window.addEventListener("message",e),parent.window.postMessage({command:"iframeReady",data:null},"*"),function(){return window.removeEventListener("message",e)}}),[]),Object(b.jsx)("div",{className:O?"main-fadeout":"main-fadein",children:a&&!O?Object(b.jsx)(ee,{harmonyData:a}):Object(b.jsx)(v,{displayStr:p,harmonyGV:o})})},ae=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,459)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),s(e),n(e),r(e),i(e)}))};i.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(te,{})}),document.getElementById("root")),ae()}},[[431,1,2]]]);
//# sourceMappingURL=main.6b5bc6af.chunk.js.map